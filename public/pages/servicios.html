<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="HTML, CSS, JavaScript"> 
    <title>Servicios</title>
    <link href="../CSS/style.css" rel="stylesheet">
    <script src="../scripts/script.js" defer></script>
    <script src="../scripts/carrito.js" defer></script>

</head>
<body>
    <header>
        <img src="../images/logo.png" width="640" height="172" alt="Logo"/>
        <div id="carrito" onclick="toggleCart()">
            <img src="../images/carrito.png" alt="Carrito de Compras">
        </div>        
    </header>
    <div id="menu-icon">
        <img src="../images/icono.png" alt="Menú" onclick="toggleMenu()">
    </div>
    <nav id="menuprincipal">
        <div>
            <u1>
                <li><a href="../index.html">Inicio</a></li>
                <li><a href="../pages/showroom.html">Showroom</a></li>
            </u1>
        </div>
    </nav>
    <article>
        <h1>Servicios</h1>
        <h2>Accesorios Off-Road</h2>
        <div class="galeria" data-categoria="accesorios">
            <!-- Los productos se cargarán aquí dinámicamente -->
        </div>
        
        <h2>Mantenimiento</h2>   
        <div class="galeria" data-categoria="mantenimiento">
            <!-- Los productos se cargarán aquí dinámicamente -->
        </div>
        
        <h2>Detailing</h2>
        <div class="galeria" data-categoria="detailing">
            <!-- Los productos se cargarán aquí dinámicamente -->
        </div>
        
        <!-- Modal para mostrar las imágenes del producto -->
        <div id="modal">
            <div id="modal-content">
                <button class="close-btn" onclick="cerrarModal()">×</button>
                <img id="main-img" src="" alt="">
                <div class="modal-img-container" id="modal-img-container"></div>
                <div id="modal-desc" class="descripcion"></div>
                <div class="cantidad">
                    <label for="cantidad">Cantidad:</label>
                    <input type="number" id="cantidad" min="1" value="1">
                </div>
                <button class="comprar-btn" onclick="comprarProducto()">Comprar</button>
            </div>
        </div>

        <div id="login-modal" class="hidden">
            <div class="login-content">
                <h2>Iniciar Sesión</h2>
                <label for="username">Usuario:</label>
                <input type="text" id="username" required>
                <label for="password">Contraseña:</label>
                <input type="password" id="password" required>
                <button id="login-button">Iniciar Sesión</button>
                <button onclick="closeLogin()">Cancelar</button>
            </div>
        </div>

        <div id="cart-modal" class="hidden">
            <div class="cart-content">
                <button class="close-cart" onclick="toggleCart()">×</button>
                <h2>Tu Carrito</h2>
                <ul id="cart-items"></ul>
                <div id="cart-summary">
                    <p>Subtotal: $<span id="subtotal">0.00</span></p>
                    <p>IVA (15%): $<span id="iva">0.00</span></p>
                    <p>Total: $<span id="total">0.00</span></p>
                </div>
                <button id="checkout-button" class="checkout-btn">Proceder al Pago</button>
            </div>
        </div>
    </article>

    <footer>
        <div id="botones">
            <nav id="pie">
                <u2>
                    <li><a href="tel:+593999312120">Llámanos</a></li>
                    <li><a href="https://www.instagram.com/topspeed.ec/">@topspeed.ec</a></li>
                </u2>
            </nav>
        </div>
    </footer>
    <script>
        // Espera a que el contenido de la página esté cargado
        document.addEventListener("DOMContentLoaded", function() {
            // Función para cargar los productos desde el JSON
            async function cargarProductos() {
                try {
                    // Obtiene los productos desde el archivo JSON
                    const response = await fetch('./data/productos.json');
                    const data = await response.json();
                    
                    // Los datos de los productos
                    const productos = data.data;
                    
                    // Referencias a las secciones donde se deben agregar los productos
                    const galeriaAccesorios = document.getElementById('accesorios');
                    const galeriaMantenimiento = document.getElementById('mantenimiento');
                    const galeriaDetailing = document.getElementById('detailing');
                    
                    // Limpia las galerías
                    galeriaAccesorios.innerHTML = '';
                    galeriaMantenimiento.innerHTML = '';
                    galeriaDetailing.innerHTML = '';
                    
                    // Iterar sobre los productos y agregarlos a las galerías correspondientes
                    productos.forEach(producto => {
                        const itemHTML = `
                            <div class="item" data-nombre="${producto[1]}" data-precio="${producto[2]}">
                                <img class="imagen" src="${producto[5]}" width="${producto[6]}" height="${producto[7]}" 
                                     onclick="abrirModal('${producto[1]}', '${producto[9]}', ${JSON.stringify(producto[10])})" alt="${producto[8]}">
                                <div class="descripcion">${producto[4]}</div>
                            </div>
                        `;
                        
                        // Clasificar los productos según su tipo
                        if (producto[1].includes('Cabrestante') || producto[1].includes('Halógenos') || producto[1].includes('Suspensión')) {
                            galeriaAccesorios.innerHTML += itemHTML;
                        } else if (producto[1].includes('Cita')) {
                            galeriaMantenimiento.innerHTML += itemHTML;
                        } else if (producto[1].includes('Detailing')) {
                            galeriaDetailing.innerHTML += itemHTML;
                        }
                    });
                } catch (error) {
                    console.error('Error al cargar los productos:', error);
                }
            }

            // Llamar a la función para cargar los productos
            cargarProductos();
        });
    </script>
</body>
</html>
